
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<META HTTP-EQUIV="pragma" CONTENT="no-cache"> 
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate"> 
<META HTTP-EQUIV="expires" CONTENT="0">
<link rel="stylesheet" href="fold.css">
<link rel="stylesheet" href="editable.css">
<link rel="stylesheet" href="navi.css">
<link rel="stylesheet" href="navi2.css">
<link rel="stylesheet" href="spin.css">
<link rel="stylesheet" href="spincss.css">
 <style type="text/css">
       
        #foo1 {
            position: fixed;
            left: 0;
            top: 0;
            _position: absolute;
            width: 100%;
            background: #000;
            opacity: 0.5;
            filter: alpha(opacity=50);
            z-index: 999;
            display: none;
        }
#foo {
  position: relative;
  background: #FFF;
  height: 20px;
  width:20px;
  display: inline-block;
}

   
    </style>

<title>Insert title here</title>
<script src="jquery-3.6.0test.js"></script>  
<script src="echarts.min.js"></script>
<script src="spin.js"></script>
<script src="spin.umd.js"></script>
</head>
<body>
<h1a ><br><h1 style="font-size:60px">太阳能工艺模拟</h1><br><br><br></h1a><br><br><br><br>
<br><br>
<ul style="font-size:30px">
  <li ><a style="padding:30px" href="#home">Home</a></li>
  <li ><a style="padding:30px" href="#news">News</a></li>
  <li  class="dropdown">
    <a style="padding:30px" href="javascript:void(0)" class="dropbtn">Dropdown</a>
    <div  class="dropdown-content"  style="min-width: 200px">
      <a  href="#">Link 1</a>
      <a  href="#">Link 2</a>
      <a  href="#">Link 3</a>
    </div>
  </li>
</ul>
<br>
<br>
<br><br>
<br>


  <div style="margin-left:0%" class="warn">输入有误，成绩请输入0~100以内的数字</div>
    <div style="margin-left:0%" class="container">
        <p class="title">磷扩散工艺模拟</p>
        <div class="hint">根据扩散工艺得出方阻和浓度分布</div>

    </div>
  
  
   
  
<div style="margin-left:0%;padding:1px 16px;height:1500px" id="accordion_wrap">
      <dl class="accordion">
         <dt><a href="#"><span style="font-size:20px">炉管参数</span></a></dt>
         <dd><p></p><p style="font-size:20px">    &ensp;&ensp;管&ensp;&ensp;&ensp;&ensp;长&ensp;：<input style="width:100px;height:25px;border:dotted;font-size:20px" id="tubelength" value="200">&ensp;&ensp;厘米<td>     &ensp;&ensp;&ensp;&ensp;炉管直径&ensp;：<input id="tuberadius" style="width:100px;height:25px;border:dotted;font-size:20px" value="30">&ensp;&ensp;厘米  &ensp;&ensp;&ensp;&ensp;石英舟长&ensp;：<input id="boatlength" style="width:100px;height:25px;border:dotted;font-size:20px" value="150">&ensp;&ensp;厘米  <br>    &ensp;&ensp;线&ensp;圈&ensp;一&ensp;：<input id="circle1" style="width:100px;height:25px;border:dotted;font-size:20px" value="30">&ensp;&ensp;厘米     &ensp;&ensp;&ensp;&ensp;线&ensp;圈&ensp;二&ensp;：<input id="circle2" style="width:100px;height:25px;border:dotted;font-size:20px" value="30">&ensp;&ensp;厘米      &ensp;&ensp;&ensp;&ensp;线&ensp;圈&ensp;三&ensp;：<input id="circle3" style="width:100px;height:25px;border:dotted;font-size:20px" value="30">&ensp;&ensp;厘米<br>&ensp;&ensp;线&ensp;圈&ensp;四&ensp;：<input id="circle4" style="width:100px;height:25px;border:dotted;font-size:20px" value="30">&ensp;&ensp;厘米      &ensp;&ensp;&ensp;&ensp;线&ensp;圈&ensp;五&ensp;：<input id="circle5" style="width:100px;height:25px;border:dotted;font-size:20px" value="30">&ensp;&ensp;厘米     &ensp;&ensp;&ensp;&ensp;线&ensp;圈&ensp;六&ensp;：<input id="circle6" style="width:100px;height:25px;border:dotted;font-size:20px" value="30">&ensp;&ensp;厘米<br>&ensp;&ensp;硅片数量&ensp;：<input id="waferamount" style="width:100px;height:25px;border:dotted;font-size:20px" value="800">&ensp;&ensp;片&ensp;&ensp;   &ensp;&ensp;&ensp;&ensp;硅片厚度&ensp;：<input id="waferthickness" style="width:100px;height:25px;border:dotted;font-size:20px" value="0.2">&ensp;&ensp;毫米          &ensp;&ensp;&ensp;&ensp;硅片尺寸&ensp;：<input id="wafersize" style="width:100px;height:25px;border:dotted;font-size:20px" value="156">&ensp;&ensp;毫米<br></td></p></dd>
       </dl>
       
        <dl class="accordion">
         <dt><a href="#"><span style="font-size:20px">扩散工艺</span></a></dt>
         <dd id="process"><table class="edtable" style="width:950px">  </table></dd><br>

       </dl>
       &emsp;&emsp;<button id="run">运行工艺</button>&emsp;&emsp;&emsp;&emsp;<div id="foo"  style="z-index:0;"></div><p class="p1"><br></p>
        <dl class="accordion">
         <dt><a href="#"><span style="font-size:20px">运行结果</span></a></dt>
         <dd id="sheetR"><p></p><table class="edtable" id="editableR" style="width:600px">  </table><p></p><br>&emsp;<button id="copyR">复制数据</button><br><br></dd>
       </dl>
       
        <dl class="accordion last_style">
         <dt><a href="#"><span style="font-size:20px">浓度分布</span></a></dt>
         <dd id="profile">&emsp;&emsp;<span id="charts" style="width: 600px; height: 400px;">           </span>&emsp;<button id="copyP">复制数据</button></dd>
       </dl>
    </div><br>

<script>

var myObj = '"name":"Bill Gates",  "age":62, "city":"Seattle"';
var myJSON = JSON.stringify(myObj);
/*function readFile(filename){ 
	alert("begin to read.");document.write("readtest");
	var fso = new ActiveXObject("Scripting.FileSystemObject"); 
	if(fso==null)alert("fso");
	var f = fso.OpenTextFile(filename,1); 
//	alert(f);
	var s = ""; 
	while (!f.AtEndOfStream) 
		s += f.ReadLine()+"/n"; 
	f.Close(); 
	alert(s);
	return s; 
} */

var url="https://diffusiondist.azurewebsites.net/ServletTest?x=%7B" +myObj+"%7D";
/*function writeFile(filename,filecontent){ 
	  var fso, f, s ; alert("write..");
	  fso = new ActiveXObject("Scripting.FileSystemObject");    
	  f = fso.OpenTextFile(filename,8,true); 
	  f.WriteLine(filecontent);   
	  f.Close(); 
		alert('write ok'); 
	} 
document.write(writeFile('D:/filetest.txt',"this is a test"));
//document.write(readFile('D:/filetest.txt'));
var url="http://localhost:8080/TEST/ServletTest?x=%7B" +myObj+"%7D";
//var url='${pageContext.request.contextPath}/ServletTest';
//window.location="http://localhost:8080/TEST/ServletTest?x=%7B" +myObj+"%7D";
//window.location='${pageContext.request.contextPath}/ServletTest'
alert("success");*/
//alert(document.getElementById("demo").innerHTML);
/*$(document).ready(function() {
var tt=$("p");
//alert((String)(tt.innerHTML));

$("#demo").text("第三段中的文本是：" + tt[2].innerHTML);
});*/
//document.write(document.getElementById("demo").innerHTML+"write");
//for(var a=0;a<=1000000000;a++){a=a;}
//document.write(document.getElementById("demo").innerHTML+"write");
//document.getElementById("demo").innerHTML
//var json;
/*$.getJSON(url).done(function(json){
	alert("success");
    document.getElementById("demo").innerHTML=json.name;
})*/
/*
alert("begin");
$.getJSON(url).done(function(json){
	alert("fn");
    //document.getElementById("demo").innerHTML=json.salesVolume;
    

    var myChart = echarts.init(document.getElementById("charts"));
	salesVolume = json.salesVolume;//销量
	bussinessVolume = json.bussinessVolume;//营业额
	months = json.months;//月份

	var option = {
			title : {
				text : 'ECharts 入门示例'
			},
			tooltip : {},
			legend : {
				data : [ '销量' ],
				data : [ '营业额' ]
			},
			xAxis : {
				data : months
			},
			yAxis : {},
			series : [ {
				name : '销量',
				type : 'bar',
				data : salesVolume
			}, {
				name : '营业额',
				type : 'line',
				data : bussinessVolume
			} ],
			toolbox : {
				show : true,
				feature : {
					mark : {
						show : true
					},
					dataView : {
						show : true,
						readOnly : false
					},
					magicType : {
						show : true,
						type : [ 'line', 'bar' ]
					},
					restore : {
						show : true
					},
					saveAsImage : {
						show : true
					}
				}
			},
		}
		myChart.setOption(option);
	//var sjson=JSON.parse(json);
//	var sjson=JSON.stringify(json);
//	document.write(sjson);
    
  //$("#demo").text("第三段中的文本是：" + json.name);
});*/

document.getElementById("run").onclick = runbutton;
document.getElementById("copyR").onclick = copyRbutton;
document.getElementById("copyP").onclick = copyPbutton;
var spinner = new Spinner();

//显示与隐藏加载动画
function showLoading(result) {
	//alert("begin");
//1    	alert("showloading");
    //var spinContainer = document.getElementById("foo");
    if (result) {
        //var target = $(spinContainer).get(0);
        //alert(spinner);alert(target);alert(spinContainer);
        //spinner.spin(target);
        //spinContainer.style.height = document.documentElement.clientHeight + "px";
        //$(spinContainer).hide();
        //alert("target");
    	var target = document.getElementById('foo');//alert(target);
    	spinner.spin(target);
    	//var spinner = new Spinner(opts).spin(target);
    	//spinContainer.style.height = document.documentElement.clientHeight + "px";
        //$(spinContainer).show();
    } else {
        spinner.stop();
        //$(spinContainer).hide();
    }
}
function runbutton(){
	var iscalcserver="1";var iscustomer="0";var isinit="0";
	var isresult="1";var issubmit="2"; var isreturn="3";
	showLoading(true);
//1	alert("run1!");
    //establishListR(operateColumnsR);
    /*var dataList = [
        { step: 1, name: '小王', time: 80, zone1: 90, zone2: 99, zone3: 90, zone4: 99, zone5: 90, zone6: 99, bigN2: 200, smallN2: 200, O2: 200, pressure: 200 },
        { step: 2, name: '小明', time: 79, zone1: 88, zone2: 75, zone3: 90, zone4: 99, zone5: 90, zone6: 99, bigN2: 220, smallN2: 200, O2: 200, pressure: 200 },
        { step: 3, name: '小超', time: 50, zone1: 67, zone2: 56, zone3: 90, zone4: 99, zone5: 90, zone6: 99, bigN2: 230, smallN2: 200, O2: 200, pressure: 200 },
        { step: 4, name: '小李', time: 60, zone1: 88, zone2: 66, zone3: 90, zone4: 99, zone5: 90, zone6: 99, bigN2: 240, smallN2: 200, O2: 200, pressure: 200 },
    ]*/
    //var myJSON = JSON.stringify(dataList[1]);
    //document.write(myJSON);
    var StrTube="", StrProcess="";
    StrTube=StrTube+$("#tubelength").val()+" "+$("#tuberadius").val()+" "+$("#boatlength").val()+" "+$("#circle1").val()+" "+$("#circle2").val()+" "+$("#circle3").val()+" "+$("#circle4").val()+" "+$("#circle5").val()+" "+$("#circle6").val()+" "+$("#waferamount").val()+" "+$("#waferthickness").val()+" "+$("#wafersize").val()+"";
    for (let i in dataList) {
        StrProcess=StrProcess+dataList[i].step+" "+dataList[i].name+" "+dataList[i].time+" "+dataList[i].zone1+" "+dataList[i].zone2+" "+dataList[i].zone3+" "+dataList[i].zone4+" "+dataList[i].zone5+" "+dataList[i].zone6+" "+dataList[i].bigN2+" "+dataList[i].smallN2+" "+dataList[i].O2+" "+dataList[i].pressure+" ";
    }
    
//1    alert("run2!");
    //var sjson=JSON.stringify(StrTube+StrProcess);
    
    var sjson= '"StrTube":"'+StrTube+'",  "StrProcess":"'+StrProcess+'"';
//1    alert(StrTube);
    //alert("ttt");
//1    alert(sjson);
    //alert("ttt1");
   // var myObj = '"name":"Bill Gates",  "age":62, "city":"Seattle"';
    //var myJSON = JSON.stringify(myObj);
    //document.write(sjson);

    var url="https://testservlet.azurewebsites.net/hello?jsoncallback=?&host="+iscustomer+"&processinfo=%7B" +sjson+"%7D";
//    window.location=url;
//1    alert("test");
    $.getJSON(url).done(function(json){
    	alert("fn");spinner.stop();
//    	alert(json.Strsheet);//alert(json.StrProfile);alert("aaa");
    	//document.write(json.StrProcess);
        //document.getElementById("demo").innerHTML=json.salesVolume;
        var months = ["0","0.01","0.02","0.03","0.04","0.05","0.06","0.07","0.08","0.09","0.10","0.11","0.12","0.13","0.14","0.15","0.16","0.17","0.18","0.19","0.20","0.21","0.22","0.23","0.24","0.25","0.26","0.27","0.28","0.29","0.30","0.31","0.32","0.33","0.34","0.35","0.36","0.37","0.38","0.39","0.40","0.41","0.42","0.43","0.44","0.45","0.46","0.47","0.48","0.49","0.50","0.51","0.52","0.53","0.54","0.55","0.56","0.57","0.58","0.59","0.60","0.61","0.62","0.63","0.64","0.65","0.66","0.67","0.68","0.69","0.70","0.71","0.72","0.73","0.74","0.75","0.76","0.77","0.78","0.79","0.80","0.81","0.82","0.83","0.84","0.85","0.86","0.87","0.88","0.89","0.90","0.91","0.92","0.93","0.94","0.95","0.96","0.97","0.98","0.99","0.100"];//,"1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93"];
//1        alert("aaa");       

        var myChart = echarts.init(document.getElementById("charts"));
    	//salesVolume = json.salesVolume;//销量
    	//bussinessVolume = json.bussinessVolume;//营业额
    	//months = json.months;//月份
        profile=json.StrProfile;
    	sheetR=json.Strsheet;
 //1   	alert(sheetR);//alert(sheetR[9]);
 //1   	alert(json.Strsheet);
    	var option = {
    			title : {
    				text : 'ECharts 入门示例'
    			},
    			tooltip : {},
    			//grid:{left:'20%',right:'2%',bottom:'10%',containlabel:true },
    			legend : {
    				//data : [ '销量' ],
    				data : [ '营业额' ]
    			},
    			xAxis : {
    				data : months,
    				
                    minInterval: 1,                                       
                    axisLabel: {                   
                    formatter: function (value, index) { 
                        value = parseFloat(value);
                        //保留小数位数
                        return value.toFixed(3);      
                    } ,               
                }              
    				
    				
    			},
    			yAxis : { 
    				//type: 'log',         min:1e12,   max:1e21,      logBase:10 ,data : [1E12,1E13,1E14,1E15,1E16,1E17,1E18,1E19,1E20,1E21]   
    				type: 'log',
    			    // type:Echart.yAxis.type,
    			    //  name:Echart.yAxis.name,
    			    //  nameGap:Echart.yAxis.nameGap,
    			   //   nameLocation:Echart.yAxis.nameLocation,
    				  // 科学记数法
    				        axisLabel: {
      formatter: function (value) {
          var res = value.toString();
          var numN1 = 0;
          var numN2 = 1;
          var num1=0;
          var num2=0;
          var t1 = 1;
          for(var k=0;k<res.length;k++){
              if(res[k]==".")
                 t1 = 0;
              if(t1)
                 num1++;
              else
                 num2++;
          }
          if(Math.abs(value)<1 && res.length>4)
          {
              for(var i=2; i<res.length; i++){
                  if(res[i]=="0"){
                      numN2++;
                  }else if(res[i]==".")
                      continue;
                  else
                      break;
              }
              var v = parseFloat(value);
              v = v * Math.pow(10,numN2);
              return v.toString() + "e-" + numN2;
          }else if(num1>5)
          {
              if(res[0]=="-")
                  numN1 = num1 - 2;
              else
                  numN1 = num1 - 1;
              var v = parseFloat(value);
              v = v / Math.pow(10,numN1);
              if(num2 > 5)
                  v = v.toFixed(4);
              return v.toString() + "e" + numN1;
          }else
              return parseFloat(value);
      }
  }
    				  /*axisLabel: {
    				    formatter: function (value) {
    				      if (Math.abs(value) > 100000) {
    				      if (value == 0) {
    				        return "0";
    				        // 检查是否已经转化为科学计数了
    				      } else if ((value + '').indexOf('e') > 0) {
    				          return (value + '').replace(/e/, "E");
    				      } else {
    				          var res = value.toString();
    				          var numN1 = 0;
    				          var numN2 = 1;
    				          var num1 = 0;
    				          var num2 = 0;
    				          var t1 = 1;
    				          // 计入小数点前后有多少位
    				          for (var k = 0; k < res.length; k++) {
    				            if (res[k] == ".")
    				                t1 = 0;
    				            if (t1)
    				                num1++;
    				            else
    				                num2++;
    				          }
    				          // 均转换为科学计数法表示
    				          if (Math.abs(value) < 1) {
    				          // 小数点后一位开始计算
    				            for (var i = 2; i < res.length; i++) {
    				              if (res[i] == "0") {
    				                numN2++; //记录10的负指数值（默认值从1开始）
    				              } else if (res[i] == ".")
    				                  continue;
    				                else
    				                  break;
    				            }
    				            var v = parseFloat(value);
    				            // 10的numN2次方
    				            v = v * Math.pow(10, numN2);
    				            v = v.toFixed(1); //四舍五入 仅保留一位小数位数
    				            return v.toString() + "e-" + numN2;
    				          } else if (num1 > 1) {
    				              numN1 = num1 - 1;
    				              var v = parseFloat(value);
    				              v = v / Math.pow(10, numN1);
    				              if (num2 > 1) {
    				                  v = v.toFixed(1);
    				              }
    				              return v.toString() + "e" + numN1;
    				            }
    				        }
    				    } else {
    				        return value;
    				      }
    				    }
    				  }*/
    			},
    			series : [ /*{
    				name : '销量',
    				type : 'bar',
    				data : profile
    			}, */{
    				name : '营业额',
    				type : 'line',
    				data : profile
    			} ],
    			toolbox : {
    				show : true,
    				feature : {
    					mark : {
    						show : true
    					},
    					dataView : {
    						show : true,
    						readOnly : false
    					},
    					magicType : {
    						show : true,
    						//type : [ 'line', 'bar' ]
    						type : [ 'line']
    					},
    					restore : {
    						show : true
    					},
    					saveAsImage : {
    						show : true
    					}
    				}
    			},
    		}
    		myChart.setOption(option);

    	dataListR = [
    	    { No: 1, location: '炉口', center: sheetR[0], leftup: sheetR[1], leftdown: sheetR[1], rightup: sheetR[1], rightdown: sheetR[1], unisingle: Math.round(Math.abs(sheetR[1]-sheetR[0])/(sheetR[1]+sheetR[0])*10000)/100+'%', uniwhole: 99, },
    	    { No: 2, location: '口中', center: sheetR[2], leftup: sheetR[3], leftdown: sheetR[3], rightup: sheetR[3], rightdown: sheetR[3], unisingle: Math.round(Math.abs(sheetR[3]-sheetR[2])/(sheetR[3]+sheetR[2])*10000)/100+'%', uniwhole: 99, },
    	    { No: 3, location: '炉中', center: sheetR[4], leftup: sheetR[5], leftdown: sheetR[5], rightup: sheetR[5], rightdown: sheetR[5], unisingle: Math.round(Math.abs(sheetR[5]-sheetR[4])/(sheetR[5]+sheetR[4])*10000)/100+'%', uniwhole: 99, },
    	    { No: 4, location: '尾中', center: sheetR[6], leftup: sheetR[7], leftdown: sheetR[7], rightup: sheetR[7], rightdown: sheetR[7], unisingle: Math.round(Math.abs(sheetR[7]-sheetR[6])/(sheetR[7]+sheetR[6])*10000)/100+'%', uniwhole: 99, },
    	    { No: 5, location: '炉尾', center: sheetR[8], leftup: sheetR[9], leftdown: sheetR[9], rightup: sheetR[9], rightdown: sheetR[9], unisingle: Math.round(Math.abs(sheetR[9]-sheetR[8])/(sheetR[9]+sheetR[8])*10000)/100+'%', uniwhole: 99, },    	]
    	/*dataListR = [
    	    { No: 1, location: '小王', center: 80, leftup: 90, leftdown: 99, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
    	    { No: 2, location: '小明', center: 79, leftup: 88, leftdown: 75, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
    	    { No: 3, location: '小超', center: 50, leftup: 67, leftdown: 56, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
    	    { No: 4, location: '小李', center: 60, leftup: 88, leftdown: 66, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
    	]*/
    	var operateColumnsR = { ediColumns: [1, 2, 3, 4,5], ediRule: [0, 100], ediSpecialRule: { 5: [0, 250] }, isTotal: false, totalEach: [2, 3, 4], isDelete: false };
    	establishListR(operateColumnsR);
    	
        $('#copyR').show();
        $('#copyP').show();
    	
    });
    
    
    
    if ($('#sheetR').is(':hidden')) {
        $(this).addClass('active');
        $('#sheetR').slideDown('fast');
    }
    
    if ($('#profile').is(':hidden')) {
        $(this).addClass('active');
        $('#profile').slideDown('fast');
    }
    
//1    alert("end");
    //window.location="http://localhost:8080/TEST/ServletTest?x=" +myJSON+"";
}
/*var dataListR = [
    { No: 1, location: '小王', center: 80, leftup: 90, leftdown: 99, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
    { No: 2, location: '小明', center: 79, leftup: 88, leftdown: 75, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
    { No: 3, location: '小超', center: 50, leftup: 67, leftdown: 56, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
    { No: 4, location: '小李', center: 60, leftup: 88, leftdown: 66, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
]*/
//1alert("rtest");
var sc=readFile("D:/C++程序/DiffusionWeb/DiffusionWeb/result.txt");
//1alert(sc);

function copyRbutton(){
	var sheetRMtr="";var sheetRarr=new Array();
	//sheetR="10,20,30,40,50,60,70,80,90,100";
	//alert(sheetR);alert(sheetR[1]+sheetR[2]);
	//var sheetRN=sheetR;alert(sheetRN);
	//sheetRarr=sheetRN.split(',');
	for (let i in sheetR){
		if(i>0){
    	if(i%2!=0)sheetRMtr=sheetRMtr+sheetR[i-1]+"\t"+sheetR[i]+"\t"+sheetR[i]+"\t"+sheetR[i]+"\t"+sheetR[i]+"\n";
    	//else sheetRMtr=sheetRMtr+sheetR[i-1]+"\n";
		
		}
	}
	//alert(sheetRN);alert(sheetRarr);
	//sheetRMtr=sheetRMtr+sheetR[0]+'\t'+sheetR[1]+'\t'+sheetR[1]+'\t'+sheetR[1]+'\t'+sheetR[1]+'\n'+sheetR[5]+'\t'+sheetR[6]+'\t'+sheetR[7]+'\t'+sheetR[8]+'\t'+sheetR[9]+'\n'+sheetR[10]+'\t'+sheetR[11]+'\t'+sheetR[12]+'\t'+sheetRarr[13]+'\t'+sheetRarr[14]+'\n'+sheetRarr[15]+'\t'+sheetRarr[16]+'\t'+sheetRarr[17]+'\t'+sheetRarr[18]+'\t'+sheetRarr[19]+'\n'+sheetRarr[20]+'\t'+sheetRarr[21]+'\t'+sheetRarr[22]+'\t'+sheetRarr[23]+'\t'+sheetRarr[24]+'\n';
	//alert(sheetRMtr);
	navigator.clipboard.writeText(sheetRMtr);
	//alert(sheetRMtr);
}
function copyPbutton(){
	var profileStr="";
	for (let i in profile){
		if(i==0)profileStr=profileStr+profile[i];
		else profileStr=profileStr+"\t"+profile[i];
	}
	navigator.clipboard.writeText(profileStr);
	alert("def");
}
</script>

<script type="text/javascript">
      function init_accordtion(){
         
         //元素是否存在，若不存在则退出
         if (!$('.accordion').length) { return;}
         
         //收集所有折叠项
        $('dl.accordion').eq(0).find('dt a').addClass('active').end().find('dd').show();

         //单击事件监听器
         $('dl.accordion dt a').on('click', function(){
            //
            var $dt = $(this).parent();  // 双亲dt节点
            var $dd =$(this).parent().next(); //对应的dd内容
            var $sibling_dl = $dt.parent().siblings();//祖先dl元素的同胞元素  
            
            //这个函数的作用是为最后一个dl控制样式的
            function findLast(){
                if ($('#accordion_wrap').find('dl:last').find('dd').is(':hidden')) {
                    $('#accordion_wrap').find('dl:last').removeClass('last_active').addClass('last_style');
                }else{
                  $('#accordion_wrap').find('dl:last').removeClass('last_style').addClass('last_active');
                }
              }
            // 点击事件的核心代码
            if ($dd.is(':hidden')) {
                $(this).addClass('active');
                $dd.slideDown('fast');
            }else{$dd.slideUp('fast');
               // $dd.slideDown('fast').parent().siblings().find('dt a').removeClass('active').end().find('dd:visible').slideUp('fast',findLast);
            };
            
            this.blur();
            return false;
 
         });
       }

      
      init_accordtion();
  </script>
<script>
//表头数据
//var dataTitle = ['学 号', '姓 名', '语 文', '数 学', '英 语', '品 德']
var dataTitle = ['步 骤', '名 称', '时 间', '温度一', '温度二', '温度三', '温度四', '温度五', '温度六', '大 氮', '小 氮', '氧 气', '压力',]
var dataTitleR=['片 数', '位 置', '中 心', '左 上', '左 下', '右 上', '右 下', '单片不均匀度', '整管不均匀度',]
//模拟json表中数据
/*var dataList = [
    { id: 1, name: '小王', chineseGrade: 80, mathGrade: 90, englishGrade: 99, moralityGrade: 200 },
    { id: 2, name: '小明', chineseGrade: 79, mathGrade: 88, englishGrade: 75, moralityGrade: 220 },
    { id: 3, name: '小超', chineseGrade: 50, mathGrade: 67, englishGrade: 56, moralityGrade: 230 },
    { id: 4, name: '小李', chineseGrade: 60, mathGrade: 88, englishGrade: 66, moralityGrade: 240 },
]*/
var dataList = [
    { step: 1, name: '小王', time: 600, zone1: 823, zone2: 823, zone3: 823, zone4: 823, zone5: 823, zone6: 823, bigN2: 1000, smallN2: 100, O2: 0.0001, pressure: 0.1 },
    { step: 2, name: '小明', time: 600, zone1: 833, zone2: 833, zone3: 833, zone4: 833, zone5: 833, zone6: 833, bigN2: 1000, smallN2: 100, O2: 1000, pressure: 0.1 },
    { step: 3, name: '小超', time: 600, zone1: 843, zone2: 843, zone3: 843, zone4: 843, zone5: 843, zone6: 843, bigN2: 1000, smallN2: 100, O2: 1000, pressure: 0.1 },
    { step: 4, name: '小李', time: 600, zone1: 853, zone2: 853, zone3: 853, zone4: 853, zone5: 853, zone6: 853, bigN2: 1000, smallN2: 100, O2: 1000, pressure: 0.1 },
]

/*var dataListR = [
    { No: 1, location: '小王', center: 80, leftup: 90, leftdown: 99, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
    { No: 2, location: '小明', center: 79, leftup: 88, leftdown: 75, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
    { No: 3, location: '小超', center: 50, leftup: 67, leftdown: 56, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
    { No: 4, location: '小李', center: 60, leftup: 88, leftdown: 66, rightup: 90, rightdown: 99, unisingle: 90, uniwhole: 99, },
]/*
//配置操作列对象
/*
（所有列都是从0开始）
ediColumns：[col1,col2,col3...] 表示你要修改的列是那几列
ediRule：[min,max] 必须是数字，表示你所要修改的列的验证规则,表示在min~max的区间之内
ediSpecialRule：{列数1:[min,max],列数2:[min.max]..}设定特殊的列不同的验证规则
isTotal：Boolean 表示是否需要总和功能
totalEach：[col1,col2,col3]需要计算总分的列数
isDelete：Boolean 表示是否需要删除功能
*/
//var operateColumns = { ediColumns: [2, 3, 4], ediRule: [0, 100], ediSpecialRule: { 5: [0, 250] }, isTotal: true, totalEach: [2, 3, 4], isDelete: true };
//var operateColumns = { ediColumns: [1, 2, 3, 4,5,6,7,8,9,10,11,12], ediRule: [0, 100], ediSpecialRule: { 5: [0, 250] }, isTotal: false, totalEach: [2, 3, 4], isDelete: true };
var operateColumns = { ediColumns: [1,2,3,4,5,6,7,8,9,10,11,12], ediRule: [0, 50000], ediSpecialRule: { 12: [0, 10],3:[0,1500],4:[0,1500],5:[0,1500],6:[0,1500],7:[0,1500],8:[0,1500] }, isTotal: false, totalEach: [2, 3, 4], isDelete: true };
var operateColumnsR = { ediColumns: [1, 2, 3, 4,5,6,7,8,9], ediRule: [0, 100], ediSpecialRule: { 5: [0, 250] }, isTotal: false, totalEach: [2, 3, 4], isDelete: false };
//生成列表事件
function establishList(operateColumns) {
    //在删除一行数据后如不清空则在调用上一次的数据就还在
    document.getElementsByClassName("edtable")[0].innerHTML = '';
    //表头模板拼接和创建
    var titleTempalte = `<tr class="list-title">`
    for (let i in dataTitle) {
        titleTempalte += `<th>${dataTitle[i]}</th>`
    }
    //判断是否有总和功能，增添表头总和字样
    if (operateColumns.isTotal) {
        titleTempalte += `<th>总 和</th>`
    }

    //判断是否有删除功能，增添表头删除字样
    if (operateColumns.isDelete) {
        titleTempalte += `<th>删 除</th>`
    }
    titleTempalte += `</tr>`
    document.getElementsByClassName("edtable")[0].insertAdjacentHTML('afterBegin', titleTempalte);

    //表内容模板生成
    //遍历列表数据
    for (one of dataList) {
        //获取所有key值
        let dataItem = Object.keys(one);
        //拼接的开头
        var listTempalte = `<tr class="list-items">`
        //表体模板拼接
        //遍历key值
        for (let key of dataItem) {
            listTempalte += `<td>${one[key]}</td>`
        }

        //判断是否需要增加总分列
        if (operateColumns.isTotal) {
            listTempalte += `<td class="total"></td>`
        }

        //判断是否有删除功能
        if (operateColumns.isDelete) {
            listTempalte += `<td><button>×</button> <button>插入</button></td>`
        }
        listTempalte += `</tr>`
        document.getElementsByClassName('edtable')[0].insertAdjacentHTML('beforeEnd', listTempalte);
    }
    totalScore(operateColumns);
}

//生成列表事件
function establishListR(operateColumns) {
    //在删除一行数据后如不清空则在调用上一次的数据就还在
    document.getElementsByClassName("edtable")[1].innerHTML = '';
    //表头模板拼接和创建
    var titleTempalte = `<tr class="list-title">`
    for (let i in dataTitleR) {
        titleTempalte += `<th>${dataTitleR[i]}</th>`
    }
    //判断是否有总和功能，增添表头总和字样
    if (operateColumnsR.isTotal) {
        titleTempalte += `<th>总 和</th>`
    }

    //判断是否有删除功能，增添表头删除字样
    if (operateColumnsR.isDelete) {
        titleTempalte += `<th>删 除</th>`
    }
    titleTempalte += `</tr>`
    document.getElementsByClassName("edtable")[1].insertAdjacentHTML('afterBegin', titleTempalte);

    //表内容模板生成
    //遍历列表数据
    for (one of dataListR) {
        //获取所有key值
        let dataItem = Object.keys(one);
        //拼接的开头
        var listTempalte = `<tr class="list-items">`
        //表体模板拼接
        //遍历key值
        for (let key of dataItem) {
            listTempalte += `<td>${one[key]}</td>`
        }

        //判断是否需要增加总分列
        if (operateColumnsR.isTotal) {
            listTempalte += `<td class="total"></td>`
        }

        //判断是否有删除功能
        if (operateColumnsR.isDelete) {
            listTempalte += `<td><button>×</button> <button>插入</button></td>`
        }
        listTempalte += `</tr>`
        document.getElementsByClassName('edtable')[1].insertAdjacentHTML('beforeEnd', listTempalte);
    }
    //totalScore(operateColumns);
}

//计算总分事件(和绑定事件)
function totalScore(operateColumns) {
    //调用生成列表事件
    let itemsNodes = document.getElementsByClassName('list-items');
    //遍历每一个tr
    for (let i of itemsNodes) {
        //计算总分
        let totalGrade = 0;
        let tdnodes = i.getElementsByTagName('td');
        //遍历所需要编辑的每一列
        for (let j of operateColumns.ediColumns) {
            //添加编辑点击事件
            tdnodes[j].onclick = ediGrade;
        }
        //判断是否需要总分列
        if (operateColumns.isTotal) {
            for (let k of operateColumns.totalEach) {
                let grade = parseInt(tdnodes[k].innerHTML);
                if (isNaN(grade)) {
                    grade = 0;
                }
                totalGrade += grade;
            }
            //计算总和并赋值
            i.getElementsByClassName('total')[0].innerHTML = totalGrade;
        }
        //判断是否需要删除列
        if (operateColumns.isDelete) {
            tdnodes[tdnodes.length - 1].getElementsByTagName('button')[0].onclick = deleteRow;
            tdnodes[tdnodes.length - 1].getElementsByTagName('button')[1].onclick = insertRow;
  //          tdnodes[tdnodes.length - 1].getElementsByTagName('button')[2].onclick = runbutton;
        }
    }
}

//点击编辑文本框事件
function ediGrade(event) {
    //创建新节点并且把输入的数字赋值给所点击的单元格
    let grade = event.target.innerHTML;
    let inputcount = document.getElementsByClassName('active-input')
    if (inputcount.length == 0) {
        var input = document.createElement("input");
        event.target.innerHTML = '';
        event.target.appendChild(input);
        input.setAttribute("class", "active-input");
        input.value = grade;
        input.focus();
        //点击其他地方进行数据保存并且调用totalScore函数让总分重新进行计算
        input.onblur = function () {
            let min, max;
            //首先给常规的验证规则
            min = operateColumns.ediRule[0];
            max = operateColumns.ediRule[1];
            //如果有特殊的验证规则
            if (Object.keys(operateColumns.ediSpecialRule).length != 0) {
                //遍历特殊验证规则
                for (i of Object.keys(operateColumns.ediSpecialRule)) {
                    //找出特殊验证规则的对应列数
                    if (event.target.cellIndex == parseInt(i) || i == undefined) {
                        min = operateColumns.ediSpecialRule[i][0];
                        max = operateColumns.ediSpecialRule[i][1];
                        break;
                    }
                }
            }
            //给对应的验证规则修改对应的提示文字
            let warninfo = '输入有误，请输入' + min + '~' + max + '以内的数字';
            document.getElementsByClassName('warn')[0].innerHTML = warninfo;
            if (isEstimate(input.value, min, max)||event.target.cellIndex==1) {
                //获取更改数据的id号
                let ediId = event.target.parentNode.children[0].innerHTML;
                //获取更改数据在td一行中的第几列（从0开始）
                let edicell = event.target.cellIndex;
                //遍历List数据
                for (let i in dataList) {
                    //找到id值对应的那一条数据
                    if (dataList[i].step == ediId) {
                        //获取要修改数据中的所有keys值数组
                        let dataKeys = Object.keys(dataList[i]);
                        //根据keys数组的索引对对象数据进行修改
                        dataList[i][dataKeys[edicell]] = parseInt(input.value);
                    }
                }
                // console.log(dataList);
                event.target.innerHTML = input.value;
                // establishList(operateColumns);
                totalScore(operateColumns);
            } else {
                document.getElementsByClassName('warn')[0].style.opacity = 1;
                setTimeout(function () {
                    document.getElementsByClassName('warn')[0].style.opacity = 0;
                }, 1500);
                input.select();
            }


        }
    }
}

//删除行事件
function deleteRow(event) {
    //对删除行的id进行获取
    let deletId = event.target.parentNode.parentNode.children[0].innerHTML;
    //遍历数据对象
    for (let i in dataList) {
        //找到删除行id值对应的那一条数据
        if (dataList[i].step == deletId) {
            //对数据列表进行删除
            dataList.splice(i, 1);
        }
    }
    establishList(operateColumns);
}

//插入行事件
function insertRow(event) {
    //对删除行的id进行获取
    let deletId = event.target.parentNode.parentNode.children[0].innerHTML;
    //遍历数据对象
    for (let i in dataList) {
        //找到删除行id值对应的那一条数据
        if (dataList[i].step == deletId) {
            //对数据列表进行删除
            dataList.splice(i, 0,dataList[i]);break;
        }
    }
    //document.write(dataList[0]);document.write(dataList[1]);document.write(dataList[2]);document.write(dataList[3]);document.write(dataList[4]);document.write(dataList[5]);
    establishList(operateColumns);
}


    
//设置修改验证规则事件  
function isEstimate(value, min, max) {
    if (min <= parseInt(value) && parseInt(value) <= max) {
        return true;
    } else {
        return false;
    }
}
//调用创建函数运行
//document.write(readFile('D:/filetest.txt'));
establishList(operateColumns);
//runbutton();
    if ($('#process').is(':hidden')) {
        $(this).addClass('active');
        $('#process').slideDown('fast');
    }
    $('#copyR').hide();
    $('#copyP').hide();
//<script type="text/javascript" language="javascript"> 
//读文件 
function readFile(filename){ 
	alert("begin to read.");document.write("readtest");
	var fso = new ActiveXObject("Scripting.FileSystemObject"); 
	if(fso==null)alert("fso");
	var f = fso.OpenTextFile(filename,1); 
	//alert(f);
	var s = ""; 
	while (!f.AtEndOfStream) 
		s += f.ReadLine()+"/n"; 
	f.Close(); 
	alert(s);
	return s; 
} 

//写文件 
function writeFile(filename,filecontent){ 
  var fso, f, s ; alert("write..");
  fso = new ActiveXObject("Scripting.FileSystemObject");    
  f = fso.OpenTextFile(filename,8,true); 
  f.WriteLine(filecontent);   
  f.Close(); 
	alert('write ok'); 
	alert("test");
} 
/*
<html> 
	<input type="text" id="in" name="in" /> 
	<input type="button" value="Write!" οnclick="writeFile('c:/12.txt',document.getElementById('in').value);"/>
	<br><br> 
	<input type="button" value="Read!" οnclick="document.getElementById('show').value=readFile('c:/12.txt');"/>
	<br> 
	
	<textarea id="show" name="show" cols="50" rows="8" > 
	</textarea> 
</html>
*/
//alert("rtest");
//document.write(writeFile('D:/filetest.txt',"this is a test"));
//var sc=readFile("D:/C++程序/DiffusionWeb/DiffusionWeb/result.txt");
//alert(sc);
</script>

</body>
</html>